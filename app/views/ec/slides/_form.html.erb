<%= form_for @ec_slide, url: @ec_slide.new_record? ? @ec_slides_path : @ec_slide, validate: true do |f| %>
  <%= f.hidden_field :slide_type %>
  <div class="modal-body">
<!--     <div class="alert alert-block alert-info ">
      <strong class="pull-left">提示：</strong>
      <ul class="vwebsiteHeadAlert">
        <li>图片建议尺寸：750像素*520像素，可支持上传格式为：jpg、png、bmp、gif。</li>
      </ul>
    </div> -->

<!--     <div class="form-group">
      <label class="control-label">展示类型<span class="required-star">*</span></label>
      <div class="clearfix">
        <%#= f.select :slide_type, EcSlide.slide_type_options[0..0], {}, class: 'col-xs-6' %>
      </div>
    </div>
 -->
    <% if @ec_slide.swipe? %>    
      <div class="form-group">
        <label class="control-label">图片<span class="required-star">*</span> <small>图片建议尺寸：750像素*520像素，支持格式：jpg、png、bmp、gif。</small></label>
        <div class="clearfix">
          <div id="logo" class="pull-left margin-right-10"></div>
          <div class="cieldon-file width-100px" data-type="0" data-div="#logo" data-height="104" data-width="150" data-img="<%= @ec_slide.pic_url %>" data-name="ec_slide[pic_key]" data-key="<%= @ec_slide.pic_key %>"></div>
        </div>
      </div>
    <% elsif @ec_slide.home_menu? %>
      <div class="form-group">
        <label class="control-label">图片<span class="required-star">*</span> <small>图片建议尺寸：140像素*160像素，支持格式：jpg、png、bmp、gif。</small></label>
        <div class="clearfix">
          <div id="logo" class="pull-left margin-right-10"></div>
          <div class="cieldon-file width-100px" data-type="0" data-div="#logo" data-height="120" data-width="104" data-img="<%= @ec_slide.pic_url %>" data-name="ec_slide[pic_key]" data-key="<%= @ec_slide.pic_key %>"></div>
        </div>
      </div>
    <% elsif @ec_slide.banner? || @ec_slide.pop_banner? %>
      <div class="form-group">
        <label class="control-label">图片<span class="required-star">*</span> <small>图片建议尺寸：700像素*440像素，支持格式：jpg、png、bmp、gif。</small></label>
        <div class="clearfix">
          <div id="logo" class="pull-left margin-right-10"></div>
          <div class="cieldon-file width-100px" data-type="0" data-div="#logo" data-height="110" data-width="175" data-img="<%= @ec_slide.pic_url %>" data-name="ec_slide[pic_key]" data-key="<%= @ec_slide.pic_key %>"></div>
        </div>
      </div>
    <% end %>

    <% if @ec_slide.bottom_menu? %>
      <%= f.hidden_field :pic_key, value: 'FrZ0PHTPAXtlsyYcrAmNmvq9OjaO' %>
      <div class="form-group">
        <label class="control-label">链接</label>
        <div class="clearfix">
          <% slides = [] %>
          <% menus = @current_site.ec_slides.bottom_menu.pluck(:url) %>
          <% current = @ec_slide.url %>
          <% ids = [] %>
          <% current_employee.employee_roles.each{|role| ids << role.permission_ids } %>
          <% EcSlide::url_options.each do |s| %>
            <% next if menus.include?(s[1]) && @ec_slide.url != s[1] %>
            <% next if s[1] == 'pages/ec/shopping-cart/shopping-cart' &&  !ids.flatten.uniq.include?(5) %>
            <% next if s[1] == 'pages/ec/category/category' && !ids.flatten.uniq.include?(5) %>
            <% next if s[1] == 'pages/site/category' && !ids.flatten.uniq.include?(23) %>
            <% next if s[1] == 'pages/site/case_list' && !ids.flatten.uniq.include?(24) %>
            <% slides.push(s) %>
          <% end %>
          <%= f.select :url, slides, class: 'col-xs-12' %>
        </div>
      </div>

      <div class="form-group">
        <label class="control-label">名称</label>
        <div class="clearfix">
          <%= f.text_field :title, class: 'col-xs-12' %>
        </div>
      </div>
    <% else %>
      <div class="form-group">
        <label class="control-label">标题</label>
        <div class="clearfix">
          <%= f.text_field :title, class: 'col-xs-12' %>
        </div>
      </div>

      <div class="form-group">
        <label class="control-label">链接</label>
        <div class="clearfix">
          <%= f.text_field :url, class: 'col-xs-12' %>
        </div>
      </div>
    <% end %>

    <div class="form-group">
      <label class="control-label">排序<span class="required-star">*</span></label>
      <div class="clearfix">
        <%= f.text_field :position, class: 'col-xs-12' %>
      </div>
    </div>

  </div>
  <div class="clearfix"></div>
  <div class="modal-footer">
    <%= f.submit '确定', class: 'btn btn-sm btn-primary', data: {fn: 'submit'} %>
    <button type="button" class="btn btn-sm btn-default" data-dismiss="modals">取消</button>
  </div>
<% end %>
<% content_for :custom_js do %>
    <script type="text/javascript">
      $(function(){
          $('input[type=submit]').click(function(){
              if($('#ec_slide_title').val()){
                  if("<%= @ec_slide.pic_url %>" == 'false' && !$('input[name="ec_slide[pic_key]"]').val()){
                      showTip('warning', '请上传图片');
                      return false;
                  }
              }
          });
      });
    </script>
<% end %>
<style type="text/css">
  select{
    width: 100%
  }
</style>